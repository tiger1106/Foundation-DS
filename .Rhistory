fsrShapereq_df$S12<-as.numeric(fsrShapereq_df$S12)
fsrShapereq_df$S13<-as.numeric(fsrShapereq_df$S13)
fsrShapereq_df$S14<-as.numeric(fsrShapereq_df$S14)
fsrShapereq_df$S15<-as.numeric(fsrShapereq_df$S15)
fsrShapereq_df$S16<-as.numeric(fsrShapereq_df$S16)
fsrShapereq_df$S17<-as.numeric(fsrShapereq_df$S17)
fsrShapereq_df$S18<-as.numeric(fsrShapereq_df$S18)
fsrShapereq_df$S19<-as.numeric(fsrShapereq_df$S19)
fsrShapereq_df$S20<-as.numeric(fsrShapereq_df$S20)
fsrShapereq_df$S21<-as.numeric(fsrShapereq_df$S21)
fsrShapereq_df$S23<-as.numeric(fsrShapereq_df$S23)
fsrShapereq_df<-fsrShapereq_df %>% separate(S1,c("S0","S1",sep="["))
fsrShapereq_df<-fsrShapereq_df %>% separate(S22,c("S22","S23",sep="]"))
fsrShape_df$S23<-as.numeric(fsrShape_df$S23)
fsrShapereq_df$S23<-as.numeric(fsrShapereq_df$S23)
fsrShapereq_df<-fsrShapereq_df %>% separate(S22,c("S22","S23",sep="]"))
fsrShapereq_df<-fsrShapereq_df %>% separate(S1,c("S0","S1",sep="["))
fsrShapereq_df<-fsrShapereq_df %>% separate(S22,c("S22","S23",sep="]"))
fsrShape_df<-fsrShape_df %>% separate(S22,c("S22","S23",sep="]"))
fsrShapereq_df<- fsr_df %>% separate(SHAPE,c("S1","S2","S3","S4","S5","S6","S7","S8","S9","S10","S11","S12","S13","S14","S15","S16","S17","S18","S19","S20","S21","S22"),sep=",")
#summary(fsrShapereq_df)
#fsrShapereq_df%>% group_by(S20)%>% summarise((cnt=n()))
fsrShapereq_df<-fsrShapereq_df %>% separate(S1,c("S0","S1",sep="["))
fsrShapereq_df<-fsrShapereq_df %>% separate(S22,c("S22","S23",sep="]"))
fsrShapereq_df$S1<-as.numeric(fsrShapereq_df$S1)
fsrShapereq_df$S2<-as.numeric(fsrShapereq_df$S2)
fsrShapereq_df$S3<-as.numeric(fsrShapereq_df$S3)
fsrShapereq_df$S4<-as.numeric(fsrShapereq_df$S4)
fsrShapereq_df$S5<-as.numeric(fsrShapereq_df$S5)
fsrShapereq_df$S6<-as.numeric(fsrShapereq_df$S6)
fsrShapereq_df$S7<-as.numeric(fsrShapereq_df$S7)
fsrShapereq_df$S8<-as.numeric(fsrShapereq_df$S8)
fsrShapereq_df$S9<-as.numeric(fsrShapereq_df$S9)
fsrShapereq_df$S10<-as.numeric(fsrShapereq_df$S10)
fsrShapereq_df$S11<-as.numeric(fsrShapereq_df$S11)
fsrShapereq_df$S12<-as.numeric(fsrShapereq_df$S12)
fsrShapereq_df$S13<-as.numeric(fsrShapereq_df$S13)
fsrShapereq_df$S14<-as.numeric(fsrShapereq_df$S14)
fsrShapereq_df$S15<-as.numeric(fsrShapereq_df$S15)
fsrShapereq_df$S16<-as.numeric(fsrShapereq_df$S16)
fsrShapereq_df$S17<-as.numeric(fsrShapereq_df$S17)
fsrShapereq_df$S18<-as.numeric(fsrShapereq_df$S18)
fsrShapereq_df$S19<-as.numeric(fsrShapereq_df$S19)
fsrShapereq_df$S20<-as.numeric(fsrShapereq_df$S20)
fsrShapereq_df$S21<-as.numeric(fsrShapereq_df$S21)
fsrShapereq_df$S23<-as.numeric(fsrShapereq_df$S23)
fsrShapereq_df<- fsrShapereq_df %>% mutate(LatitudeN=Latitude,LongitudeN=Longitude)
fsrShapereq_df$LatitudeN<- as.numeric(fsrShapereq_df$LatitudeN)  # convert latitude to numeric
fsrShapereq_df$LongitudeN<- as.numeric(fsrShapereq_df$LongitudeN)
fsrgraph_df<- fsrShapereq_df %>% select(ComplaintType,SRType,SRCategory,SRSource,SRStatus,BoroughCode,Postcode,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,InitiatedDate,ClosedDate,LongitudeN,LatitudeN)
Head(fsrgraph_df)
Head(fsrgraph_df)
head(fsrgraph_df)
ggplot(fsrgraph_df,x=LongitudeN,y=LatitudeN,col= ComplaintType)+geom_point()
library(readr)
library(plyr)
library(tidyr)
library(dplyr)
library(ggplot2)
ggplot(fsrgraph_df,x=LongitudeN,y=LatitudeN,col= ComplaintType)+geom_point()
ggplot(fsrgraph_df,aes(x=LongitudeN,y=LatitudeN,col= ComplaintType))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= ComplaintType))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= SRSource))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= PostcodeF))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= Postcode))+ geom_point()
ggplot(fsrgraph_df,aes(x=SRtype))+geom_histogram()
ggplot(fsrgraph_df,aes(x=SRType))+geom_histogram()
ggplot(fsrgraph_df,aes(x=SRType))+ geom_bar()
ggplot(fsrgraph_df,aes(x=SRType))+ geom_histogram()
ggplot(fsrgraph_df,aes(x=SRType))+ geom_histogram(stat="count")
ggplot(fsrgraph_df,aes(x=S1,y=S2, col=SRType))+geom_point()
ggplot(fsrgraph_df,aes(x=S2,y=S3, col=SRType))+geom_point()
ggplot(fsrgraph_df,aes(x=S7,y=S13, col=SRType))+geom_point()
Summary(fsrgraph_df$SRCategory)
summary(fsrgraph_df$SRCategory)
fsrgraph_df$SRCategory
fsrgraph_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% filter(SRCategory=="Hazard")%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% filter(SRCategory=="Hazard","Prune")%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% filter(SRCategory=="Hazard"|"Prune")%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% filter(SRCategory=="Hazard",SRCategory=="Prune")%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% filter(SRCategory=="Hazard")%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% filter(SRCategory=="Hazard")%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df%>% select(SRCategory,SRType) %>% distinct() %>%  group_by(SRCategory,SRType)%>% tally(desc(TRUE)) # Question on Output
fsrReqtype_df%>% select(SRCategory,SRType,SRResolution)%>% group_by(SRResolution)%>% filter(SRCategory== "Hazard",SRResolution!= "Work Completed")
fsrReqtype_df%>% select(SRCategory,SRType,SRResolution)%>% group_by(SRResolution)%>% filter(SRCategory== "Hazard"|"Prune",SRResolution!= "Work Completed")
fsrgraph_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% filter(SRCategory %in% c("Hazard","Prune","Remove Tree","Root/Sewar/Sidewalk","Illegal Tree Damage"))%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df<- fsrShapereq_df %>%
select(ComplaintType,SRType,SRCategor
fsrgraph_df<- fsrShapereq_df %>%
select(ComplaintType,SRType,SRCategory,SRSource,SRStatus,BoroughCode,Postcode,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,InitiatedDate,ClosedDate,LongitudeN,LatitudeN) %>% filter(SRCategory %in% c("Hazard","Prune","Remove Tree","Root/Sewar/Sidewalk","Illegal Tree Damage"))
fsrgraph_df<- fsrShapereq_df %>% select(ComplaintType,SRType,SRCategory,SRSource,SRStatus,BoroughCode,Postcode,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,InitiatedDate,ClosedDate,LongitudeN,LatitudeN) %>% filter(SRCategory %in% c("Hazard","Prune","Remove Tree","Root/Sewar/Sidewalk","Illegal Tree Damage"))
ggplot(fsrgraph_df,aes(x=S7,y=S13, col=SRType))+geom_point()
ggplot(fsrgraph_df,aes(x=SRType))+ geom_histogram(stat="count")
ggplot(fsrgraph_df,aes(x=S7,y=S13, col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S20, col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S21, col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S21))+geom_point() + geom_point(aes(x=S13.y=S11,col=SRCategory))
ggplot(fsrgraph_df,aes(x=S19,y=S21))+geom_point() + geom_point(aes(x=S13,y=S11,col=SRCategory))
ggplot(fsrgraph_df,aes(x=S19,y=S21))+geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S21,col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S21,col=SRCategory))+geom_bar()
ggplot(fsrgraph_df,aes(x=S19,y=S21,col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= Factor(S11)))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= S11))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= S7))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= S13))+ geom_point()
FStidy_df<- fsrgraph_df%>% select(SRCategory,S8,S11,S12,S13)
FStidy_df<- fsrgraph_df%>% select(SRCategory,S8,S11,S12,S13) %>% gather(key,value,-SRCategory)
FStidy_df
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= S21))+ geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S21,col=SRCategory))+geom_point()
fsrgraph_df %>% group_by(S9) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S2) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S3) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S4) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S5) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S6) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S7) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S8) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S9) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S10) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S11) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S12) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S13) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S13) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #6
fsrgraph_df %>% group_by(S14) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S15) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S16) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S17) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S18) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S19) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S20) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S7) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S21) %>% summarise(cnt=n()) %>% arrange(desc(cnt)) #4
fsrgraph_df %>% group_by(S23) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S9) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  # more than 76
fsrgraph_df %>% group_by(S8) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  # more than 103 Values
ggplot(fsrgraph_df,aes(x=S10,y=S21, col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=S10,y=S11, col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S21,col=SRCategory))+geom_jitter()
FStidy_df<- fsrgraph_df%>% select(SRCategory,S12,S13) %>% gather(key,value,-SRCategory)
FStidy_df
ggplot(fsrgraph_df,aes(x=SRCategory,y=Value, col=key))+geom_jitter()+facet_grid(.~key)
ggplot(fsrgraph_df,aes(x=SRCategory,y=Value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
ggplot(fsrgraph_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
ggplot(FStidy_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
FStidy_df<- fsrgraph_df%>% select(SRCategory,S10,S13) %>% gather(key,value,-SRCategory)
ggplot(FStidy_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
FStidy_df<- fsrgraph_df%>% select(SRCategory,S10,S9) %>% gather(key,value,-SRCategory) # Notice: illegal tree Damage
ggplot(FStidy_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
FStidy_df
summary(FStidy_df)
FStidy_df<- fsrgraph_df%>% select(SRCategory,S11,S9) %>% gather(key,value,-SRCategory) # Notice: illegal tree Damage
ggplot(FStidy_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
FStidy_df<- fsrgraph_df%>% select(SRCategory,S11,S19) %>% gather(key,value,-SRCategory) # Notice: illegal tree Damage
ggplot(FStidy_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
FStidy_df<- fsrgraph_df%>% select(SRCategory,S20,S19) %>% gather(key,value,-SRCategory) # Notice: illegal tree Damage
ggplot(FStidy_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= ComplaintType))+ geom_point()
load("C:/Users/Naksh/Desktop/R Project/titanic3.xls")
titanic3 <- read_excel("C:/Users/Naksh/Desktop/R Project/titanic3.xls")
titanic3 <- read_excel("C:/Users/Naksh/Desktop/R Project/titanic3.xls")
library(readr)
titanic3 <- read_csv("C:/Users/Naksh/Desktop/R Project/titanic3.xls")
View(titanic3)
View(titanic3)
View(SRTypecnt)
library(readxl)
titanic3 <- read_excel("C:/Users/Naksh/Desktop/titanic3.xlsx")
View(titanic3)
titanic3 <- read_excel("C:/Users/Naksh/Desktop/titanic3.xlsx")
Tit_df<- titanic3
Titan_Exc_df<- titanic3
Titan_Exc_df<- titanic3
library(readr)
library(plyr)
library(tidyr)
library(dplyr)
titanic3 <- read_excel("C:/Users/Naksh/Desktop/titanic3.xlsx")
Titan_Exc_df<- titanic3
library(readr)
library(plyr)
library(tidyr)
library(dplyr)
titanic3 <- read_excel("C:/Users/Naksh/Desktop/titanic3.xlsx")
library(readxl)
titanic3 <- read_excel("C:/Users/Naksh/Desktop/titanic3.xlsx")
View(titanic3)
Titan_Exc_df<- titanic3
ggplot(titanic, aes(x = Pclass,y=Age, col = Sex)) +
geom_point(size=3,alpha=0.5,position = posn.jd) + facet_grid( .~ Survived)
library(readr)
library(dplyr)
library(tidyr)
# titanic is avaliable in your workspace
# 1 - Check the structure of titanic
str(titanic)
# 2 - Use ggplot() for the first instruction
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge")
# 3 - Plot 2, add facet_grid() layer
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge") + facet_grid( .~ Survived)
# 4 - Define an object for position jitterdodge, to use below
posn.jd <- position_jitterdodge(0.5, 0, 0.6)
# 5 - Plot 3, but use the position object from instruction 4
ggplot(titanic, aes(x = Pclass,y=Age, col = Sex)) +
geom_point(size=3,alpha=0.5,position = posn.jd) + facet_grid( .~ Survived)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
# titanic is avaliable in your workspace
# 1 - Check the structure of titanic
str(titanic)
# 2 - Use ggplot() for the first instruction
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge")
# 3 - Plot 2, add facet_grid() layer
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge") + facet_grid( .~ Survived)
# 4 - Define an object for position jitterdodge, to use below
posn.jd <- position_jitterdodge(0.5, 0, 0.6)
# 5 - Plot 3, but use the position object from instruction 4
ggplot(titanic, aes(x = Pclass,y=Age, col = Sex)) +
geom_point(size=3,alpha=0.5,position = posn.jd) + facet_grid( .~ Survived)
library(readr)
dataset <- read_csv(NULL)
View(dataset)
library(readr)
titanic3 <- read_csv("C:/Users/Naksh/Desktop/R Project/titanic3.xls")
View(titanic3)
View(titanic3)
library(readr)
titanic_original <- read_csv("C:/Users/Naksh/Desktop/R Project/titanic_original.csv")
View(titanic_original)
titanic<- titanic_original
str(titanic)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
titanic<- titanic_original
# titanic is avaliable in your workspace
# 1 - Check the structure of titanic
str(titanic)
# 2 - Use ggplot() for the first instruction
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge")
# 3 - Plot 2, add facet_grid() layer
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge") + facet_grid( .~ Survived)
# 4 - Define an object for position jitterdodge, to use below
posn.jd <- position_jitterdodge(0.5, 0, 0.6)
# 5 - Plot 3, but use the position object from instruction 4
ggplot(titanic, aes(x = Pclass,y=Age, col = Sex)) +
geom_point(size=3,alpha=0.5,position = posn.jd) + facet_grid( .~ Survived)
str(titanic)
# 2 - Use ggplot() for the first instruction
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge")
# 3 - Plot 2, add facet_grid() layer
ggplot(titanic, aes(x = Pclass, fill = Sex)) +
geom_bar(position = "dodge") + facet_grid( .~ Survived)
titanic<- titanic_clean
summary(titanic_original_df)
titanic_original
summary(titanic_original)
titanic_clean <- titanic_original %>%  mutate(embarked = replace(embarked,is.na(embarked), "S"))
titanic_clean<-titanic_original_df%>% mutate(age=replace(age,is.na(age),mean(titanic_original_df$age,na.rm=TRUE)))
titanic_clean<-titanic_original%>% mutate(age=replace(age,is.na(age),mean(titanic_original$age,na.rm=TRUE)))
titanic_clean <- titanic_original %>%  mutate (boat=replace(boat,is.na(boat),"NONE"))
titanic_clean<- titanic_original %>% mutate(hasCabinNum = ifelse(is.na(cabin),1,0))
titanic_clean
titanic<- titanic_clean
str(titanic)
ggplot(titanic, aes(x = Pclass, fill = Sex)) +   geom_bar(position = "dodge")
ggplot(titanic, aes(x = pclass, fill = Sex)) +   geom_bar(position = "dodge")
ggplot(titanic, aes(x = pclass, fill = sex)) +   geom_bar(position = "dodge")
ggplot(titanic, aes(x = pclass, fill = sex)) +   geom_bar(position = "dodge") + facet_grid( .~ survived)
ggplot(titanic, aes(x = pclass,y=age, col = sex)) + geom_point(size=3,alpha=0.5,position = posn.jd) + facet_grid( .~ survived)
library(readr)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
titanic_original
summary(titanic_original)
# Get count of NA
#titanic_original_df %>% group_by(embarked) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
# Replace NA in embarked
#titanic_original_df %>% filter(embarked=="S") %>% group_by(embarked) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
#titanic_original_df %>% group_by(age) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
titanic_clean <- titanic_original %>%  mutate(embarked = replace(embarked,is.na(embarked), "S"))
#replacing NA in Age
#titanic_clean<-titanic_original_df%>% mutate(age=replace(age,is.na(age),mean(titanic_original_df$age,na.rm=TRUE)))
#titanic_clean %>% group_by(age) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
titanic_clean<-titanic_original%>% mutate(age=replace(age,is.na(age),mean(titanic_original$age,na.rm=TRUE)))
#median(titanic_clean$age,na.rm=TRUE)
#mean(titanic_clean$age,na.rm=TRUE)
# Replacing NA in Boat
titanic_clean <- titanic_original %>%  mutate (boat=replace(boat,is.na(boat),"NONE"))
#adding has cabin number column
#titanic_original_df$cabin
titanic_clean<- titanic_original %>% mutate(hasCabinNum = ifelse(is.na(cabin),1,0))
#titanic_clean$hasCabinNum
titanic_clean
titanic<- titanic_clean
# titanic is avaliable in your workspace
# 1 - Check the structure of titanic
str(titanic)
# 2 - Use ggplot() for the first instruction
ggplot(titanic, aes(x = pclass, fill = sex)) +   geom_bar(position = "dodge")
# 3 - Plot 2, add facet_grid() layer
ggplot(titanic, aes(x = pclass, fill = sex)) +   geom_bar(position = "dodge") + facet_grid( .~ survived)
# 4 - Define an object for position jitterdodge, to use below
posn.jd <- position_jitterdodge(0.5, 0, 0.6)
# 5 - Plot 3, but use the position object from instruction 4
ggplot(titanic, aes(x = pclass,y=age, col = sex)) + geom_point(size=3,alpha=0.5,position = posn.jd) + facet_grid( .~ survived)
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= ComplaintType))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= SRSource))+ geom_point()
library(readr)
library(readr)
library(plyr)
library(tidyr)
library(dplyr)
library(ggplot2)
Forestry_Service_Requests <- read_csv("C:/Users/Naksh/Desktop/R Project/Forestry_Service_Requests.csv")
View(Forestry_Service_Requests)
fsr_df<-data.frame(Forestry_Service_Requests)
# Calculation of Date Diff
fsr_df %>% select(contains("Date"))
# Analysis of date
# Adding column Resolution Date populated with Update date
#fsr_df<-fsr_df %>% select(contains("Date")) %>% mutate(ResolutionDate=ifelse(fsr_df$UpdatedDate!="NA",fsr_df$UpdatedDate,0))
fsrdt_df  <- fsr_df %>% select(contains("Date"))%>% mutate(ResolutionDate=UpdatedDate)
#Not Working
#fsr_df %>%mutate(myCreatedDate=as.Date(myCreatedDate,"%m%d%Y"))
fsrdt_df$myCreatedDate<- as.Date(fsrdt_df$CreatedDate,"%m/%d/%Y")
fsrdt_df$ResolutionDate<- as.Date(fsrdt_df$ResolutionDate,"%m/%d/%Y")
fsrdt_df<-fsrdt_df%>%mutate(time_diff=ResolutionDate-myCreatedDate)
#fsrdt_df%>%filter(UpdatedDate=="<NA>") # not able to filter on NA
# separate year and month from created date and create factors on Year and Month
#fsrdt_df%>% mutate(year=separate(myCreatedDate,c("year,month,date"),sep="-")) # question
fsrdt_df<-fsrdt_df %>% mutate(tempcreatedate=myCreatedDate)%>% separate(tempcreatedate,c("year","Month","Date"),sep="-")
fsrdt_df$year_factor<-factor(fsrdt_df$year,ordered = TRUE,levels = c("2017","2016","2015"))
fsrdt_df$Month_factor<-factor(fsrdt_df$Month) # Ordered True is is giving NA
levels(fsrdt_df$Month_factor) <- c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
str(fsrdt_df)
#Analysis of date and Time time_diff
summary(fsrdt_df)
mean(fsrdt_df$time_diff,na.rm=TRUE)
fsrdt_df%>%group_by(Month)%>%sample_frac(.1)
fsrdt_df%>%group_by(Month)%>% top_n(3,time_diff)
fsrdt_df%>% group_by(year)%>%summarise(cnt=n())  # Error This funtion should not call directly
fsrdt_df%>%group_by(Month_factor)%>% tally(sort=TRUE)
fsrdt_df%>%group_by(time_diff)%>% tally(sort=TRUE)
#fsrdt_df%>%group_by(year,Month,Date)%>%summarise(cnt=n())%>% ungroup()%>%arrange(desc(cnt())) # Same Summarise error
#Analysis of location
fsr_df%>%group_by(Postcode)%>% tally(sort=TRUE) # how to use lattitude/Longitude
fsr_df%>% group_by(BoroughCode,Council.District) %>% tally(sort=TRUE)
fsr_df %>% select(BoroughCode,Council.District) %>% distinct() %>% filter(BoroughCode=="Queens")
fsr_df %>% select(BoroughCode,Council.District) %>% distinct() %>% filter(BoroughCode=="Manhattan")
fsr_df %>% select(Longitude,Latitude,fsrdt_df$time_diff)%>% group_by(Postcode)   # common locations????
fsrloc_df<-fsr_df%>% select(Latitude,Longitude,Postcode,BoroughCode) %>% mutate(LatitudeN=Latitude,LongitudeN=Longitude)
fsrloc_df$LatitudeN<- as.numeric(fsrloc_df$LatitudeN)  # convert latitude to numeric
fsrloc_df$LongitudeN<- as.numeric(fsrloc_df$LongitudeN) # convert longitude to numeric
fsrloc_df<- fsrloc_df %>% mutate(BoroughCodeF=BoroughCode,PostcodeF=Postcode)
fsrloc_df$BoroughCodeF<-factor(fsrloc_df$BoroughCodeF)  # Convert BoroughCode and Postcode to factor
fsrloc_df$PostcodeF<-as.character(fsrloc_df$PostcodeF)
fsrloc_df$PostcodeF<-factor(fsrloc_df$PostcodeF)
summary(fsrloc_df)
# Separate Shape paramters
fsr_df%>%group_by(SHAPE)%>% tally(sort=TRUE)
fsrShape_df<-fsr_df %>% select(contains("SHAPE"))
fsrShape_df<-fsrShape_df %>% separate(SHAPE,c("S1","S2","S3","S4","S5","S6","S7","S8","S9","S10","S11","S12","S13","S14","S15","S16","S17","S18","S19","S20","S21","S22"),sep=",")
fsrShape_df<-fsrShape_df %>% separate(S1,c("S0","S1",sep="["))
fsrShape_df<-fsrShape_df %>% separate(S22,c("S22","S23",sep="]"))
fsrShape_df$S1<-as.numeric(fsrShape_df$S1)
fsrShape_df$S2<-as.numeric(fsrShape_df$S2)
fsrShape_df$S3<-as.numeric(fsrShape_df$S3)
fsrShape_df$S4<-as.numeric(fsrShape_df$S4)
fsrShape_df$S5<-as.numeric(fsrShape_df$S5)
fsrShape_df$S6<-as.numeric(fsrShape_df$S6)
fsrShape_df$S7<-as.numeric(fsrShape_df$S7)
fsrShape_df$S8<-as.numeric(fsrShape_df$S8)
fsrShape_df$S9<-as.numeric(fsrShape_df$S9)
fsrShape_df$S10<-as.numeric(fsrShape_df$S10)
fsrShape_df$S11<-as.numeric(fsrShape_df$S11)
fsrShape_df$S12<-as.numeric(fsrShape_df$S12)
fsrShape_df$S13<-as.numeric(fsrShape_df$S13)
fsrShape_df$S14<-as.numeric(fsrShape_df$S14)
fsrShape_df$S15<-as.numeric(fsrShape_df$S15)
fsrShape_df$S16<-as.numeric(fsrShape_df$S16)
fsrShape_df$S17<-as.numeric(fsrShape_df$S17)
fsrShape_df$S18<-as.numeric(fsrShape_df$S18)
fsrShape_df$S19<-as.numeric(fsrShape_df$S19)
fsrShape_df$S20<-as.numeric(fsrShape_df$S20)
fsrShape_df$S21<-as.numeric(fsrShape_df$S21)
fsrShape_df$S23<-as.numeric(fsrShape_df$S23)
summary(fsrShape_df)
# Complaint and service request analysis
#fsrReqtype_df<- fsr_df %>% select(ComplaintType,SRCategory,SRType,SRPriority,SRResolution,Descriptor1)
#summary(fsrReqtype_df)
#fsrReqtype_df %>% group_by(ComplaintType,SRType,SRCategory,SRResolution,Descriptor1)%>% tally()
#fsrReqtype_df %>% group_by(SRCategory)%>% tally(desc(TRUE))   # How to ignore NA
#fsrReqtype_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrReqtype_df%>% select(SRCategory,SRType,SRResolution)%>% group_by(SRResolution)%>% filter(SRCategory== "Hazard",SRResolution!= "Work Completed")
#fsr_df%>% select(SRCategory,SRType) %>% distinct() %>%  group_by(SRCategory,SRType)%>% tally(desc(TRUE)) # Question on Output
# Counts
##SRCatcnt<-fsrReqtype_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
#SRTypecnt<-fsrReqtype_df %>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
#S2Cnt<- table(fsr_df$SRType,fsrShape_df$S2)
#S2Cnt
# Shape and Request analysis
fsrShapereq_df<- fsr_df %>% separate(SHAPE,c("S1","S2","S3","S4","S5","S6","S7","S8","S9","S10","S11","S12","S13","S14","S15","S16","S17","S18","S19","S20","S21","S22"),sep=",")
#summary(fsrShapereq_df)
#fsrShapereq_df%>% group_by(S20)%>% summarise((cnt=n()))
fsrShapereq_df<-fsrShapereq_df %>% separate(S1,c("S0","S1",sep="["))
fsrShapereq_df<-fsrShapereq_df %>% separate(S22,c("S22","S23",sep="]"))
fsrShapereq_df$S1<-as.numeric(fsrShapereq_df$S1)
fsrShapereq_df$S2<-as.numeric(fsrShapereq_df$S2)
fsrShapereq_df$S3<-as.numeric(fsrShapereq_df$S3)
fsrShapereq_df$S4<-as.numeric(fsrShapereq_df$S4)
fsrShapereq_df$S5<-as.numeric(fsrShapereq_df$S5)
fsrShapereq_df$S6<-as.numeric(fsrShapereq_df$S6)
fsrShapereq_df$S7<-as.numeric(fsrShapereq_df$S7)
fsrShapereq_df$S8<-as.numeric(fsrShapereq_df$S8)
fsrShapereq_df$S9<-as.numeric(fsrShapereq_df$S9)
fsrShapereq_df$S10<-as.numeric(fsrShapereq_df$S10)
fsrShapereq_df$S11<-as.numeric(fsrShapereq_df$S11)
fsrShapereq_df$S12<-as.numeric(fsrShapereq_df$S12)
fsrShapereq_df$S13<-as.numeric(fsrShapereq_df$S13)
fsrShapereq_df$S14<-as.numeric(fsrShapereq_df$S14)
fsrShapereq_df$S15<-as.numeric(fsrShapereq_df$S15)
fsrShapereq_df$S16<-as.numeric(fsrShapereq_df$S16)
fsrShapereq_df$S17<-as.numeric(fsrShapereq_df$S17)
fsrShapereq_df$S18<-as.numeric(fsrShapereq_df$S18)
fsrShapereq_df$S19<-as.numeric(fsrShapereq_df$S19)
fsrShapereq_df$S20<-as.numeric(fsrShapereq_df$S20)
fsrShapereq_df$S21<-as.numeric(fsrShapereq_df$S21)
fsrShapereq_df$S23<-as.numeric(fsrShapereq_df$S23)
# Changing locations to numeric in ShapeReq
fsrShapereq_df<- fsrShapereq_df %>% mutate(LatitudeN=Latitude,LongitudeN=Longitude)
fsrShapereq_df$LatitudeN<- as.numeric(fsrShapereq_df$LatitudeN)  # convert latitude to numeric
fsrShapereq_df$LongitudeN<- as.numeric(fsrShapereq_df$LongitudeN)
fsrgraph_df<- fsrShapereq_df %>% select(ComplaintType,SRType,SRCategory,SRSource,SRStatus,BoroughCode,Postcode,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,InitiatedDate,ClosedDate,LongitudeN,LatitudeN) %>% filter(SRCategory %in% c("Hazard","Prune","Remove Tree","Root/Sewar/Sidewalk","Illegal Tree Damage"))
#fsrgraph_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
#fsrgraph_df %>% filter(SRCategory %in% c("Hazard","Prune","Remove Tree","Root/Sewar/Sidewalk","Illegal Tree Damage"))%>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(S7) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  # 128, 192,0, 64
fsrgraph_df %>% group_by(S8) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  # 103 Values
fsrgraph_df %>% group_by(S9) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #  76
fsrgraph_df %>% group_by(S10) %>% summarise(cnt=n()) %>% arrange(desc(cnt)) #256
fsrgraph_df %>% group_by(S11) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #256
fsrgraph_df %>% group_by(S12) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #256
fsrgraph_df %>% group_by(S13) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #6
fsrgraph_df %>% group_by(S16) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  # 94
fsrgraph_df %>% group_by(S17) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #77
fsrgraph_df %>% group_by(S18) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #254
fsrgraph_df %>% group_by(S19) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #256
fsrgraph_df %>% group_by(S20) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  #256
fsrgraph_df %>% group_by(S21) %>% summarise(cnt=n()) %>% arrange(desc(cnt)) # 20
# Transform Data set
FStidy_df<- fsrgraph_df%>% select(SRCategory,S20,S19) %>% gather(key,value,-SRCategory) # Notice: illegal tree Damage
summary(FStidy_df)
#Data Visualization
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= ComplaintType))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= SRSource))+ geom_point()
ggplot(fsrgraph_df,aes(x=LatitudeN,y=LongitudeN,col= Postcode))+ geom_point()
ggplot(fsrgraph_df,aes(x=SRType))+ geom_histogram(stat="count")
ggplot(fsrgraph_df,aes(x=S10,y=S11, col=SRCategory))+geom_point()
ggplot(fsrgraph_df,aes(x=S19,y=S21,col=SRCategory))+geom_jitter()
ggplot(FStidy_df,aes(x=SRCategory,y=value, col=key))+geom_jitter()+facet_grid(.~SRCategory)
fsrReqtype_df<- fsr_df %>% select(ComplaintType,SRCategory,SRType,SRPriority,SRResolution,Descriptor1)
fsrReqtype_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrReqtype_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsrgraph_df %>% group_by(SRCategory) %>% summarise(cnt=n())
fsrgraph_df %>% group_by(SRCategory)
fsrgraph_df %>% group_by(ComplaintType)
fsrgraph_df %>% group_by(S7) %>% summarise(cnt=n()) %>% arrange(desc(cnt))  # 128, 192,0, 64
Forestry_Service_Requests <- read_csv("C:/Users/Naksh/Desktop/R Project/Forestry_Service_Requests.csv")
library(readr)
library(plyr)
library(tidyr)
library(dplyr)
library(ggplot2)
Forestry_Service_Requests <- read_csv("C:/Users/Naksh/Desktop/R Project/Forestry_Service_Requests.csv")
fsr_df
fsr_df
view(fsr_df)
View(fsr_df)
fsr_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(ComplaintType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(ComplaintDetails) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(SRType) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(SRPriority) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(SRSource) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(SRStatus) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(SRCategory) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(SRResolution) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(BoroughCode) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(CommunityBoard) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(ParkName) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(ParkZone) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(Postcode) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(StateSenate) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
fsr_df %>% group_by(StateAssembly) %>% summarise(cnt=n()) %>% arrange(desc(cnt))
setwd("~/GitHub/Foundation-DS")
